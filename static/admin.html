<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --dark: #1e1b4b;
            --darker: #0f0a1e;
            --card-bg: rgba(30, 27, 75, 0.8);
            --border: rgba(139, 92, 246, 0.2);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #0f0a1e 0%, #1a1333 50%, #0f0a1e 100%);
            min-height: 100vh;
            color: #e2e8f0;
        }
        .login-page {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
            background: radial-gradient(circle at 50% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%);
        }
        .login-box {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 48px 40px;
            width: 100%;
            max-width: 420px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            animation: fadeUp 0.5s ease;
        }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .login-header { text-align: center; margin-bottom: 36px; }
        .login-header .icon {
            width: 72px; height: 72px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 20px;
            display: flex; align-items: center; justify-content: center;
            margin: 0 auto 20px;
            font-size: 32px;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }
        .login-header h1 {
            font-size: 28px; font-weight: 700;
            background: linear-gradient(135deg, #fff, #a5b4fc);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        .login-header p { color: #94a3b8; font-size: 14px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: #a5b4fc; font-weight: 500; font-size: 14px; }
        .form-group input {
            width: 100%; padding: 14px 16px;
            border: 1px solid var(--border); border-radius: 12px;
            background: rgba(15, 10, 30, 0.6); color: #fff; font-size: 15px; transition: all 0.3s;
        }
        .form-group input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); }
        .form-group input::placeholder { color: #64748b; }
        .login-btn {
            width: 100%; padding: 14px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white; border: none; border-radius: 12px;
            font-weight: 600; font-size: 15px; cursor: pointer; transition: all 0.3s; margin-top: 8px;
        }
        .login-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4); }
        .error-msg { background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: #fca5a5; padding: 12px 16px; border-radius: 10px; margin-bottom: 20px; display: none; font-size: 14px; }
        .admin-panel { display: none; min-height: 100vh; }
        .top-bar { background: var(--card-bg); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); padding: 16px 32px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .top-bar .logo { display: flex; align-items: center; gap: 12px; }
        .top-bar .logo-icon { width: 42px; height: 42px; background: linear-gradient(135deg, var(--primary), var(--secondary)); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .top-bar .logo h1 { font-size: 20px; font-weight: 700; background: linear-gradient(135deg, #fff, #a5b4fc); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .top-bar .user-area { display: flex; align-items: center; gap: 16px; }
        .top-bar .user-info { text-align: right; }
        .top-bar .user-name { font-weight: 600; color: #fff; }
        .top-bar .user-role { font-size: 12px; color: #94a3b8; }
        .logout-btn { background: linear-gradient(135deg, var(--danger), #dc2626); color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: 500; font-size: 14px; transition: all 0.3s; }
        .logout-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(239, 68, 68, 0.3); }
        .main-layout { display: grid; grid-template-columns: 260px 1fr; min-height: calc(100vh - 74px); }
        .sidebar { background: var(--card-bg); border-right: 1px solid var(--border); padding: 24px 16px; }
        .nav-section { margin-bottom: 24px; }
        .nav-section-title { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: #64748b; padding: 0 12px; margin-bottom: 8px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: 10px; color: #94a3b8; cursor: pointer; transition: all 0.2s; margin-bottom: 4px; font-size: 14px; font-weight: 500; }
        .nav-item:hover { background: rgba(99, 102, 241, 0.1); color: #a5b4fc; }
        .nav-item.active { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3); }
        .nav-item .icon { font-size: 18px; width: 24px; text-align: center; }
        .content-area { padding: 32px; overflow-y: auto; }
        .section { display: none; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .section.active { display: block; }
        .section-header { margin-bottom: 28px; }
        .section-title { font-size: 28px; font-weight: 700; color: #fff; margin-bottom: 8px; }
        .section-subtitle { color: #94a3b8; font-size: 15px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-bottom: 32px; }
        .stat-card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 24px; transition: all 0.3s; }
        .stat-card:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3); }
        .stat-card .stat-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; margin-bottom: 16px; }
        .stat-card .stat-icon.purple { background: rgba(139, 92, 246, 0.2); }
        .stat-card .stat-icon.blue { background: rgba(59, 130, 246, 0.2); }
        .stat-card .stat-icon.green { background: rgba(16, 185, 129, 0.2); }
        .stat-card .stat-icon.orange { background: rgba(245, 158, 11, 0.2); }
        .stat-value { font-size: 32px; font-weight: 700; color: #fff; margin-bottom: 4px; }
        .stat-label { color: #94a3b8; font-size: 14px; }
        .card { background: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 24px; margin-bottom: 24px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .card-title { font-size: 18px; font-weight: 600; color: #fff; }
        .btn { padding: 10px 20px; border: none; border-radius: 10px; font-weight: 500; font-size: 14px; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; gap: 8px; }
        .btn-primary { background: linear-gradient(135deg, var(--primary), var(--secondary)); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(99, 102, 241, 0.4); }
        .btn-danger { background: linear-gradient(135deg, var(--danger), #dc2626); color: white; }
        .btn-danger:hover { transform: translateY(-2px); box-shadow: 0 5px 20px rgba(239, 68, 68, 0.3); }
        .btn-sm { padding: 6px 12px; font-size: 13px; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr auto; gap: 16px; align-items: end; }
        .form-row input { padding: 12px 16px; border: 1px solid var(--border); border-radius: 10px; background: rgba(15, 10, 30, 0.6); color: #fff; font-size: 14px; }
        .form-row input:focus { outline: none; border-color: var(--primary); }
        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 14px 16px; font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; color: #64748b; border-bottom: 1px solid var(--border); font-weight: 600; }
        td { padding: 16px; border-bottom: 1px solid var(--border); color: #e2e8f0; font-size: 14px; }
        tr:hover { background: rgba(99, 102, 241, 0.05); }
        .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; }
        .status-active { background: rgba(16, 185, 129, 0.2); color: #34d399; }
        .status-inactive { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
        .alert { padding: 14px 18px; border-radius: 10px; margin-bottom: 20px; display: none; font-size: 14px; }
        .alert-success { background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); color: #34d399; }
        .alert-error { background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); color: #fca5a5; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; }
        .info-item { background: rgba(15, 10, 30, 0.5); padding: 16px 20px; border-radius: 10px; border: 1px solid var(--border); }
        .info-item .label { font-size: 12px; color: #64748b; margin-bottom: 4px; }
        .info-item .value { color: #fff; font-weight: 500; }
        .api-status { display: flex; align-items: center; gap: 8px; }
        .api-status .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--success); animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .danger-zone { border: 1px solid rgba(239, 68, 68, 0.3); background: rgba(239, 68, 68, 0.05); }
        .danger-zone .card-title { color: #fca5a5; }
        .mobile-menu-btn { display: none; background: linear-gradient(135deg, var(--primary), var(--secondary)); border: none; color: white; padding: 10px 16px; border-radius: 10px; cursor: pointer; font-size: 18px; }
        .mobile-nav { display: none; background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 20px; }
        .mobile-nav.show { display: block; }
        .mobile-nav .nav-item { margin-bottom: 8px; }
        @media (max-width: 900px) { 
            .main-layout { grid-template-columns: 1fr; } 
            .sidebar { display: none; } 
            .content-area { padding: 20px; } 
            .form-row { grid-template-columns: 1fr; } 
            .mobile-menu-btn { display: inline-flex; align-items: center; gap: 8px; }
            .top-bar { flex-wrap: wrap; gap: 10px; }
            .top-bar .logo h1 { font-size: 16px; }
        }
    </style>
</head>
<body>
    <div class="login-page" id="loginPage">
        <div class="login-box">
            <div class="login-header">
                <div class="icon">&#9881;</div>
                <h1>Admin Dashboard</h1>
                <p>Enter your credentials to continue</p>
            </div>
            <div class="error-msg" id="loginError"></div>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group"><label>Username</label><input type="text" id="username" placeholder="Enter username" required autocomplete="off"></div>
                <div class="form-group"><label>Password</label><input type="password" id="password" placeholder="Enter password" required autocomplete="off"></div>
                <button type="submit" class="login-btn">Sign In</button>
            </form>
        </div>
    </div>
    <div class="admin-panel" id="adminPanel">
        <div class="top-bar">
            <div class="logo">
                <button class="mobile-menu-btn" onclick="toggleMobileNav()">&#9776; Menu</button>
                <div class="logo-icon">&#9881;</div>
                <h1>Admin Dashboard</h1>
            </div>
            <div class="user-area">
                <div class="user-info"><div class="user-name" id="userDisplay">Administrator</div><div class="user-role">System Admin</div></div>
                <button class="logout-btn" onclick="handleLogout()">Logout</button>
            </div>
        </div>
        <div class="main-layout">
            <div class="sidebar">
                <div class="nav-section"><div class="nav-section-title">Main</div>
                    <div class="nav-item active" onclick="showSection('dashboard', this)"><span class="icon">&#128200;</span><span>Dashboard</span></div>
                    <div class="nav-item" onclick="showSection('orders', this)"><span class="icon">&#128722;</span><span>Orders</span></div>
                </div>
                <div class="nav-section"><div class="nav-section-title">Management</div>
                    <div class="nav-item" onclick="showSection('vip', this)"><span class="icon">&#128101;</span><span>VIP Users</span></div>
                    <div class="nav-item" onclick="showSection('settings', this)"><span class="icon">&#9881;</span><span>Settings</span></div>
                </div>
                <div class="nav-section"><div class="nav-section-title">System</div>
                    <div class="nav-item" onclick="showSection('apis', this)"><span class="icon">&#128268;</span><span>API Status</span></div>
                    <div class="nav-item" onclick="showSection('danger', this)"><span class="icon">&#9888;</span><span>Danger Zone</span></div>
                </div>
            </div>
            <div class="content-area">
                <div class="mobile-nav" id="mobileNav">
                    <div class="nav-section-title">Navigation</div>
                    <div class="nav-item" onclick="showSection('dashboard', this); closeMobileNav()"><span class="icon">&#128200;</span><span>Dashboard</span></div>
                    <div class="nav-item" onclick="showSection('orders', this); closeMobileNav()"><span class="icon">&#128722;</span><span>Orders</span></div>
                    <div class="nav-item" onclick="showSection('vip', this); closeMobileNav()"><span class="icon">&#128101;</span><span>VIP Users</span></div>
                    <div class="nav-item" onclick="showSection('settings', this); closeMobileNav()"><span class="icon">&#9881;</span><span>Settings</span></div>
                    <div class="nav-item" onclick="showSection('apis', this); closeMobileNav()"><span class="icon">&#128268;</span><span>API Status</span></div>
                    <div class="nav-item" onclick="showSection('danger', this); closeMobileNav()"><span class="icon">&#9888;</span><span>Danger Zone</span></div>
                </div>
                <div id="dashboard" class="section active">
                    <div class="section-header"><h2 class="section-title">Dashboard</h2><p class="section-subtitle">Overview of your system status</p></div>
                    <div class="stats-grid">
                        <div class="stat-card"><div class="stat-icon purple">&#128722;</div><div class="stat-value" id="dashboardOrders">0</div><div class="stat-label">Total Orders</div></div>
                        <div class="stat-card"><div class="stat-icon blue">&#128101;</div><div class="stat-value" id="vipCount">1</div><div class="stat-label">VIP Users</div></div>
                        <div class="stat-card"><div class="stat-icon green">&#10004;</div><div class="stat-value">Online</div><div class="stat-label">System Status</div></div>
                        <div class="stat-card"><div class="stat-icon orange">&#128268;</div><div class="stat-value">4</div><div class="stat-label">API Endpoints</div></div>
                    </div>
                    <div class="card"><div class="card-header"><h3 class="card-title">System Information</h3></div>
                        <div class="info-grid">
                            <div class="info-item"><div class="label">Server Port</div><div class="value">5000</div></div>
                            <div class="info-item"><div class="label">Status</div><div class="value api-status"><span class="dot"></span> Running</div></div>
                            <div class="info-item"><div class="label">Last Update</div><div class="value" id="lastUpdate">Just now</div></div>
                            <div class="info-item"><div class="label">Version</div><div class="value">1.0.0</div></div>
                        </div>
                    </div>
                </div>
                <div id="orders" class="section">
                    <div class="section-header"><h2 class="section-title">Orders</h2><p class="section-subtitle">Manage purchase orders</p></div>
                    <div class="card"><div class="card-header"><h3 class="card-title">All Orders</h3><button class="btn btn-primary" onclick="loadOrders()">Refresh</button></div>
                        <table><thead><tr><th>ID</th><th>Telegram</th><th>Free Fire ID</th><th>Plan</th><th>Amount</th><th>Status</th><th>Date</th></tr></thead>
                        <tbody id="ordersTable"><tr><td colspan="7" style="text-align: center; color: #64748b; padding: 40px;">No orders found</td></tr></tbody></table>
                    </div>
                </div>
                <div id="vip" class="section">
                    <div class="section-header"><h2 class="section-title">VIP Users</h2><p class="section-subtitle">Manage VIP user accounts</p></div>
                    <div class="alert alert-success" id="successAlert"></div><div class="alert alert-error" id="errorAlert"></div>
                    <div class="card"><div class="card-header"><h3 class="card-title">Add New VIP User</h3></div>
                        <div class="form-row" style="grid-template-columns: 1fr 1fr 100px auto;">
                            <input type="text" id="newUsername" placeholder="Username" maxlength="20">
                            <input type="password" id="newPassword" placeholder="Password" maxlength="20">
                            <input type="number" id="newDays" placeholder="Days" value="30" min="1" max="365" style="text-align: center;">
                            <button class="btn btn-primary" onclick="addVipUser()">Add User</button>
                        </div>
                    </div>
                    <div class="card"><div class="card-header"><h3 class="card-title">VIP Users List</h3><button class="btn btn-primary btn-sm" onclick="loadVipUsers()">Refresh</button></div>
                        <table><thead><tr><th>Username</th><th>Status</th><th>Activated</th><th>Expires</th><th>Days</th><th>Actions</th></tr></thead>
                        <tbody id="vipUsersTable"><tr><td colspan="6" style="text-align: center; color: #64748b;">Loading...</td></tr></tbody></table>
                    </div>
                </div>
                <div id="settings" class="section">
                    <div class="section-header"><h2 class="section-title">Settings</h2><p class="section-subtitle">Configure system settings</p></div>
                    <div class="card"><div class="card-header"><h3 class="card-title">Account Settings</h3></div>
                        <div class="info-grid"><div class="info-item"><div class="label">Admin Username</div><div class="value">H4RDIXXADMIN</div></div><div class="info-item"><div class="label">Session Timeout</div><div class="value">24 hours</div></div></div>
                    </div>
                </div>
                <div id="apis" class="section">
                    <div class="section-header"><h2 class="section-title">API Status</h2><p class="section-subtitle">Monitor external API connections</p></div>
                    <div class="card"><table><thead><tr><th>API Name</th><th>Endpoint</th><th>Status</th></tr></thead><tbody>
                        <tr><td>Ghost Attack</td><td><code>217.154.239.23:14008</code></td><td><span class="status-badge status-active">Connected</span></td></tr>
                        <tr><td>Dance System</td><td><code>87.106.82.84:14233</code></td><td><span class="status-badge status-active">Connected</span></td></tr>
                        <tr><td>Player Info</td><td><code>87.106.82.84:13522</code></td><td><span class="status-badge status-active">Connected</span></td></tr>
                        <tr><td>Outfit Image</td><td><code>hamza-outfit-a1jr.vercel.app</code></td><td><span class="status-badge status-active">Connected</span></td></tr>
                    </tbody></table></div>
                </div>
                <div id="danger" class="section">
                    <div class="section-header"><h2 class="section-title">Danger Zone</h2><p class="section-subtitle">Critical system operations</p></div>
                    <div class="card danger-zone"><div class="card-header"><h3 class="card-title">System Actions</h3></div>
                        <p style="color: #fca5a5; margin-bottom: 20px; font-size: 14px;">These actions can affect system stability.</p>
                        <button class="btn btn-danger" onclick="clearCache()">Clear Cache</button>
                        <button class="btn btn-danger" onclick="resetSessions()">Reset Sessions</button>
                        <button class="btn btn-danger" onclick="reboot()">Restart System</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        const ADMIN_USER = 'H4RDIXXADMIN';
        const ADMIN_PASS = 'H4XADMIN';
        function handleLogin(e) {
            e.preventDefault();
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;
            if (user === ADMIN_USER && pass === ADMIN_PASS) {
                localStorage.setItem('adminAuth', 'true');
                localStorage.setItem('adminUser', user);
                showAdminPanel();
            } else {
                const err = document.getElementById('loginError');
                err.textContent = 'Invalid credentials';
                err.style.display = 'block';
                setTimeout(() => err.style.display = 'none', 3000);
            }
        }
        function showAdminPanel() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            document.getElementById('userDisplay').textContent = localStorage.getItem('adminUser') || 'Administrator';
            loadVipUsers();
            updateDashboardOrders();
        }
        function updateDashboardOrders() {
            const orders = JSON.parse(localStorage.getItem('ff_secure_orders') || '[]');
            document.getElementById('dashboardOrders').textContent = orders.length;
        }
        function handleLogout() { localStorage.removeItem('adminAuth'); location.reload(); }
        function toggleMobileNav() {
            document.getElementById('mobileNav').classList.toggle('show');
        }
        function closeMobileNav() {
            document.getElementById('mobileNav').classList.remove('show');
        }
        function showSection(id, el) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(m => m.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            if (el) el.classList.add('active');
        }
        function showAlert(type, message) {
            const alertEl = document.getElementById(type === 'success' ? 'successAlert' : 'errorAlert');
            alertEl.textContent = message;
            alertEl.style.display = 'block';
            setTimeout(() => alertEl.style.display = 'none', 4000);
        }
        async function loadVipUsers() {
            try {
                const response = await fetch('/api/vip/users');
                const data = await response.json();
                if (data.success) {
                    const users = data.users;
                    const table = document.getElementById('vipUsersTable');
                    table.innerHTML = '';
                    let count = 0;
                    for (const [username, info] of Object.entries(users)) {
                        count++;
                        const row = document.createElement('tr');
                        const statusClass = info.active ? 'status-active' : 'status-inactive';
                        const statusText = info.active ? 'Active' : (info.expires_at !== 'Unlimited' ? 'Expired' : 'Inactive');
                        row.innerHTML = `
                            <td><strong>${username}</strong></td>
                            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                            <td>${info.activated_at || info.created}</td>
                            <td>${info.expires_at || 'Unlimited'}</td>
                            <td>${info.days || 'Unlimited'}</td>
                            <td>
                                <button class="btn btn-primary btn-sm" onclick="editUser('${username}')">Edit</button>
                                ${username !== 'admin' ? `<button class="btn btn-danger btn-sm" onclick="deleteUser('${username}')">Delete</button>` : ''}
                            </td>`;
                        table.appendChild(row);
                    }
                    document.getElementById('vipCount').textContent = count;
                }
            } catch (error) { console.error('Error loading VIP users:', error); }
        }
        async function addVipUser() {
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            const days = document.getElementById('newDays').value || 30;
            if (!username || !password) { showAlert('error', 'Please fill all fields'); return; }
            try {
                const response = await fetch('/api/vip/users', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ username, password, days: parseInt(days) }) });
                const data = await response.json();
                if (data.success) { showAlert('success', data.message); document.getElementById('newUsername').value = ''; document.getElementById('newPassword').value = ''; document.getElementById('newDays').value = '30'; loadVipUsers(); }
                else { showAlert('error', data.message); }
            } catch (error) { showAlert('error', 'Failed to add user'); }
        }
        async function deleteUser(username) {
            if (!confirm(`Delete user "${username}"?`)) return;
            try {
                const response = await fetch(`/api/vip/users/${username}`, { method: 'DELETE' });
                const data = await response.json();
                if (data.success) { showAlert('success', data.message); loadVipUsers(); }
                else { showAlert('error', data.message); }
            } catch (error) { showAlert('error', 'Failed to delete user'); }
        }
        function editUser(username) {
            const newPass = prompt(`Enter new password for "${username}":`);
            if (!newPass) return;
            fetch(`/api/vip/users/${username}`, { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ password: newPass }) })
            .then(r => r.json()).then(data => { if (data.success) showAlert('success', data.message); else showAlert('error', data.message); })
            .catch(() => showAlert('error', 'Failed to update user'));
        }
        function loadOrders() {
            const orders = JSON.parse(localStorage.getItem('ff_secure_orders') || '[]');
            const table = document.getElementById('ordersTable');
            if (orders.length === 0) { table.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #64748b; padding: 40px;">No orders found</td></tr>'; return; }
            table.innerHTML = '';
            orders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>#${order.id || 'N/A'}</td><td>${order.telegram || 'N/A'}</td><td>${order.ff_id || 'N/A'}</td><td>${order.plan || 'N/A'}</td><td>${order.amount || 'N/A'}</td><td><span class="status-badge status-active">Completed</span></td><td>${order.date || 'N/A'}</td>`;
                table.appendChild(row);
            });
        }
        function clearCache() { if (confirm('Clear all cache data?')) { localStorage.removeItem('ff_secure_orders'); showAlert('success', 'Cache cleared'); updateDashboardOrders(); } }
        function resetSessions() { if (confirm('Reset all sessions?')) showAlert('success', 'Sessions reset'); }
        function reboot() { if (confirm('Restart the system?')) showAlert('success', 'System restart initiated'); }
        if (localStorage.getItem('adminAuth') === 'true') showAdminPanel();
        document.getElementById('lastUpdate').textContent = new Date().toLocaleString();
    </script>
</body>
</html>
